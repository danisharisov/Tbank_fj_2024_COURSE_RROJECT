# PickAFlick: –°–µ—Ä–≤–∏—Å –≤—ã–±–æ—Ä–∞ —Ñ–∏–ª—å–º–æ–≤

## üìú –û–±–∑–æ—Ä
**PickAFlick** ‚Äî —ç—Ç–æ Telegram-–±–æ—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∏ –æ—Ü–µ–Ω–∫–∏ —Ñ–∏–ª—å–º–æ–≤. –°–µ—Ä–≤–∏—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Ñ–∏–ª—å–º—ã, –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –æ—Ü–µ–Ω–∫–∞–º–∏ –∏ –≤—ã–±–∏—Ä–∞—Ç—å, —á—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–∑—å—è–º–∏. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ñ–∏–ª—å–º–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OMDb API.

---

## üöÄ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π Telegram-–±–æ—Ç**: –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
- **–û—Ü–µ–Ω–∫–∞ —Ñ–∏–ª—å–º–æ–≤**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Ñ–∏–ª—å–º—ã –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—Ä–µ–¥–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ —Å–≤–æ–∏—Ö –¥—Ä—É–∑–µ–π.
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–∑—å—è–º–∏**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –¥—Ä—É–∑–µ–π –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞.
- **–°–ø–∏—Å–∫–∏ —Ñ–∏–ª—å–º–æ–≤**: –°–ø–∏—Å–∫–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OMDb API**: –î–∞–Ω–Ω—ã–µ –æ —Ñ–∏–ª—å–º–∞—Ö (–ø–æ—Å—Ç–µ—Ä—ã, –æ–ø–∏—Å–∞–Ω–∏—è, –æ—Ü–µ–Ω–∫–∏) –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: HTTPS –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Telegram Webhook.

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è**: Java (Spring Boot)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL
- **–û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π**: RabbitMQ
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä**: Nginx
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker, Docker Compose
- **–í–Ω–µ—à–Ω–∏–µ API**: OMDb API
- **SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**: Let‚Äôs Encrypt

---

## ‚öô –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
1. **Telegram-–±–æ—Ç**:
    - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—è –∫–æ–º–∞–Ω–¥—ã –∏ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ Webhook.
    - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –±—ç–∫–µ–Ω–¥—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è–º–∏.
2. **–ë—ç–∫–µ–Ω–¥**:
    - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ RabbitMQ.
    - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ.
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**:
    - PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, —Ñ–∏–ª—å–º–∞—Ö, –æ—Ü–µ–Ω–∫–∞—Ö –∏ –¥—Ä—É–∑—å—è—Ö.
4. **–û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π**:
    - RabbitMQ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ –ø–æ—Ä—è–¥–∫–µ –æ—á–µ—Ä–µ–¥–∏.
5. **Nginx**:
    - –†–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å–∏ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ HTTPS —á–µ—Ä–µ–∑ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã.
6. **OMDb API**:
    - –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –æ —Ñ–∏–ª—å–º–∞—Ö (–Ω–∞–∑–≤–∞–Ω–∏—è, –ø–æ—Å—Ç–µ—Ä—ã, —Ä–µ–π—Ç–∏–Ω–≥–∏).

![–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](https://github.com/user-attachments/assets/a3ef89e5-6d26-4017-9d6f-7b9b11c3d3d0)


---

## üìö –°—Ç—É–∫—Ç—É—Ä–∞ –ë–î

![DB](https://github.com/user-attachments/assets/df17e00f-660a-45d0-a910-30008585cd37)


## üåê –î–µ–ø–ª–æ–π
–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker. Nginx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫—É HTTPS —á–µ—Ä–µ–∑ Let‚Äôs Encrypt. Webhook URL Telegram-–±–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ HTTPS.

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

### –û–ø–∏—Å–∞–Ω–∏–µ
–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –∑–∞–ø—É—Å–∫–∞: 
1. **`local_dev`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è TelegramLongPollingBot.
2. **`review_dev_to_webhook`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Telegram Webhook.

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **Java 17+**
- **PostgreSQL 14+**
- **Docker –∏ Docker Compose** (–¥–ª—è –≤–µ—Ç–∫–∏ `review_dev_to_webhook`)
- **RabbitMQ** (–ª–∏–±–æ –≤ Docker, –ª–∏–±–æ –ª–æ–∫–∞–ª—å–Ω–æ)
- **nginx** (–¥–ª—è –≤–µ—Ç–∫–∏ —Å –≤–µ–±—Ö—É–∫–∞–º–∏)

---

## üöÄ –ó–∞–ø—É—Å–∫ –≤–µ—Ç–∫–∏ `local_dev`

### ‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `application.properties`
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `src/main/resources/application.properties` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/{–í–ê–®–ï_–ò–ú–Ø_–ë–î}
spring.datasource.username={–í–ê–®_–ü–û–°–¢–ì–†–ï–°_–õ–û–ì–ò–ù}
spring.datasource.password={–í–ê–®_–ü–û–°–¢–ì–†–ï–°_–ü–ê–†–û–õ–¨}
telegram.bot.token={–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê}
omdb.api.key={–í–ê–®_–ö–õ–Æ–ß_OMDB_API}
```

1. **–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL**
```sql
CREATE DATABASE movie_ratings_db;
```
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ RabbitMQ**
```bash
docker run -d --name rabbitmq -p 5672:5672 rabbitmq
```
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç**

## üöÄ –ó–∞–ø—É—Å–∫ –≤–µ—Ç–∫–∏ `review_dev_to_webhook` (or main)
1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
```.env
POSTGRES_DB=movie_ratings_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=admin

RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672

SPRING_DATASOURCE_URL=jdbc:postgresql://db:5432/movie_ratings_db
SPRING_DATASOURCE_USERNAME=postgres
SPRING_DATASOURCE_PASSWORD=admin

TELEGRAM_BOT_TOKEN={–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê_–¢–ï–õ–ï–ì–†–ê–ú}
TELEGRAM_BOT_USERNAME={–í–ê–®_–Æ–ó–ï–†–ù–ï–ô–ú_–ë–û–¢–ê}
WEBHOOK_URL=https://{–í–ê–®_–î–û–ú–ï–ù}/webhook
WEBHOOK_SECRET_TOKEN={–í–ê–®_–°–ï–ö–†–ï–¢–ù–´–ô_–ö–õ–Æ–ß}

OMDB_API_KEY={–í–ê–®_–ö–õ–Æ–ß_OMDB_API}
OMDB_API_URL=http://www.omdbapi.com
```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram Webhook
```default.conf
server {
    listen 80;
    server_name {–í–ê–®_–î–û–ú–ï–ù};
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name {–í–ê–®_–î–û–ú–ï–ù};

    ssl_certificate /etc/letsencrypt/live/{–í–ê–®_–î–û–ú–ï–ù}/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/{–í–ê–®_–î–û–ú–ï–ù}/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    location /webhook {
        proxy_pass http://app:8080/webhook;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Telegram-Bot-Api-Secret-Token $http_x_telegram_bot_api_secret_token;

        proxy_connect_timeout 5s;
        proxy_send_timeout 5s;
        proxy_read_timeout 5s;

        limit_except POST {
            deny all;
        }
    }

    location / {
        proxy_pass http://app:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_connect_timeout 5s;
        proxy_send_timeout 5s;
        proxy_read_timeout 5s;
    }
}
```
1. **–°–æ–±–µ—Ä–∏—Ç–µ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ**
```bash
docker-compose up -d
```
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Webhook –≤ Telegram: –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å**
```bash
curl -X POST "https://api.telegram.org/bot{–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê}/setWebhook?url={–í–ê–®_–î–û–ú–ï–ù}&secret_token={–í–ê–®_–°–ï–ö–†–ï–¢–ù–´–ô_–ö–õ–Æ–ß}"
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- **–î–ª—è –≤–µ—Ç–∫–∏ review_dev_to_webhook —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTPS.**
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ letsencrypt –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.**
